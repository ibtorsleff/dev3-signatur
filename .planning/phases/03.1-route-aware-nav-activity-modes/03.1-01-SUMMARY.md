---
phase: 03.1-route-aware-nav-activity-modes
plan: 01
subsystem: ui
tags: [blazor, navigation, routing, code-behind, IDisposable]

# Dependency graph
requires:
  - phase: 01-infrastructure-shell
    provides: "NavMenu.razor with static hardcoded config, NavMenuConfig data model"
provides:
  - "INavigationConfigService interface for route-to-nav-config resolution"
  - "NavigationConfigService with area-based route mapping"
  - "NavMenu code-behind with LocationChanged event subscription"
  - "Dynamic Row 1 active state, Row 2 mode tabs based on current URL"
affects: [03.1-02, phase-4, candidate-detail-navigation]

# Tech tracking
tech-stack:
  added: []
  patterns: [code-behind partial class, LocationChanged event subscription, IDisposable cleanup, route-to-config service]

key-files:
  created:
    - src/SignaturPortal.Web/Components/Services/INavigationConfigService.cs
    - src/SignaturPortal.Web/Components/Services/NavigationConfigService.cs
    - src/SignaturPortal.Web/Components/Layout/NavMenu.razor.cs
  modified:
    - src/SignaturPortal.Web/Components/Layout/NavMenu.razor
    - src/SignaturPortal.Web/Program.cs

key-decisions:
  - "NavigationConfigService registered as Singleton (stateless pure function of path)"
  - "Row 2 mode tabs shown unconditionally (permission-based visibility deferred to later phase)"
  - "Detail page /activities/123 maps to Ongoing tab (detail is within ongoing context)"
  - "Service registered in Program.cs since it lives in Web project namespace"

patterns-established:
  - "Route-to-config service: centralized INavigationConfigService resolves URL path to NavMenuConfig"
  - "Code-behind pattern for NavMenu: partial class with [Inject], OnInitialized, Dispose"
  - "LocationChanged + InvokeAsync(StateHasChanged) for SPA navigation updates"

# Metrics
duration: 2min
completed: 2026-02-16
---

# Phase 03.1 Plan 01: Route-Aware Navigation Config Summary

**Route-aware NavMenu with INavigationConfigService resolving URL paths to dynamic Row 1/Row 2/Row 3 tab configurations**

## Performance

- **Duration:** 2 min
- **Started:** 2026-02-16T10:46:36Z
- **Completed:** 2026-02-16T10:48:49Z
- **Tasks:** 2
- **Files modified:** 5

## Accomplishments
- INavigationConfigService and NavigationConfigService provide centralized route-to-nav-config resolution
- NavMenu code-behind subscribes to LocationChanged for SPA navigation updates without page reload
- Row 1 "Sagsliste" icon highlights dynamically when on /activities paths
- Row 2 shows Draft/Ongoing/Closed mode tabs with correct selected state for all activity routes
- Row 3 hidden when no sub-navigation items exist (activity list area)

## Task Commits

Each task was committed atomically:

1. **Task 1: Create INavigationConfigService and NavigationConfigService** - `062fe06` (feat)
2. **Task 2: Convert NavMenu to route-aware with code-behind** - `5dfb3f5` (feat)

## Files Created/Modified
- `src/SignaturPortal.Web/Components/Services/INavigationConfigService.cs` - Interface for route-to-nav-config resolution
- `src/SignaturPortal.Web/Components/Services/NavigationConfigService.cs` - Route-aware config with area resolution, Row 1/2/3 item generation
- `src/SignaturPortal.Web/Components/Layout/NavMenu.razor.cs` - Code-behind with LocationChanged subscription and IDisposable
- `src/SignaturPortal.Web/Components/Layout/NavMenu.razor` - Pure template, removed @code block and @inject directives
- `src/SignaturPortal.Web/Program.cs` - Added singleton registration for INavigationConfigService

## Decisions Made
- NavigationConfigService registered as Singleton because it is stateless (pure function of path input, no dependencies)
- Row 2 activity mode tabs shown unconditionally -- permission-based visibility (Draft requires UserCanAccessRecruitmentDraftActivities, Closed requires IsInternal) deferred to a later phase when the permission system is more complete
- Detail pages like /activities/123 map to the "Ongoing" tab selection (detail is within ongoing context)
- Service registered in Program.cs rather than Infrastructure DependencyInjection.cs since the service lives in the Web project namespace

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness
- Navigation config service ready for Plan 02 (activity list modes with filtered views)
- NavigationConfigService extensible for future areas (statistics, admin, etc.)
- Row 3 items return empty list, ready for candidate detail sub-navigation in future phases

## Self-Check: PASSED

All 5 files verified present. Both task commits (062fe06, 5dfb3f5) verified in git log.

---
*Phase: 03.1-route-aware-nav-activity-modes*
*Completed: 2026-02-16*

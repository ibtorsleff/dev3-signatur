---
phase: 03.2-activity-list-layout-matching
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/SignaturPortal.Web/wwwroot/css/portal-themes/_grid-base.css
  - src/SignaturPortal.Web/wwwroot/css/portal-themes/theme-recruiting.css
  - src/SignaturPortal.Web/wwwroot/css/portal-themes/theme-adportal.css
  - src/SignaturPortal.Web/Components/App.razor
  - src/SignaturPortal.Web/Components/Layout/MainLayout.razor
  - src/SignaturPortal.Web/Components/Layout/NavMenuConfig.cs
  - src/SignaturPortal.Web/Components/Services/NavigationConfigService.cs
  - src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor
  - src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor.cs
  - src/SignaturPortal.Web/wwwroot/app.css
autonomous: false

must_haves:
  truths:
    - "Activity list cells use Tahoma font at 14px with 11px 13px padding, matching legacy"
    - "Activity list header row has light teal background (#e6f6f6) matching legacy"
    - "Activity list rows show #e6f6f6 hover background with pointer cursor"
    - "Activity list has no box shadow (legacy has none)"
    - "Activity list toolbar matches legacy content-headline bar styling"
    - "MudDataGrid column filters are hidden by default"
    - "User can click a filter toggle button to show column filter row"
    - "Column widths are controlled via ColGroup for consistent layout"
    - "Theme CSS class (theme-recruiting) wraps the page content in MainLayout"
    - "All grid colors come from CSS custom properties, not hardcoded values"
    - "A second portal theme (ad portal purple stub) exists to prove reusability"
  artifacts:
    - path: "src/SignaturPortal.Web/wwwroot/css/portal-themes/_grid-base.css"
      provides: "Shared grid styling via CSS custom properties"
      contains: "portal-data-grid"
    - path: "src/SignaturPortal.Web/wwwroot/css/portal-themes/theme-recruiting.css"
      provides: "Recruiting portal CSS variable values (teal #1a9b89)"
      contains: "theme-recruiting"
    - path: "src/SignaturPortal.Web/wwwroot/css/portal-themes/theme-adportal.css"
      provides: "Ad portal CSS variable stub (purple #421a56)"
      contains: "theme-adportal"
    - path: "src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor"
      provides: "Styled activity list with portal-data-grid class, ColGroup, filter toggle"
      contains: "portal-data-grid"
  key_links:
    - from: "src/SignaturPortal.Web/Components/Layout/MainLayout.razor"
      to: "theme-recruiting CSS class"
      via: "NavMenuConfig.ThemeCssClass cascaded to wrapper div"
      pattern: "theme-recruiting"
    - from: "src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor"
      to: "wwwroot/css/portal-themes/_grid-base.css"
      via: "Class=\"portal-data-grid\" on MudDataGrid"
      pattern: "portal-data-grid"
    - from: "wwwroot/css/portal-themes/_grid-base.css"
      to: "wwwroot/css/portal-themes/theme-recruiting.css"
      via: "CSS variable references (var(--portal-grid-*))"
      pattern: "var\\(--portal-grid"
---

<objective>
Make the Blazor activity list visually match the legacy WebForms layout with a reusable, portal-themed CSS system.

Purpose: The activity list must look like the legacy system (same fonts, spacing, colors, density) while building a reusable theming pattern that works across multiple portals with different color schemes. This is a LOCKED requirement -- not a one-off styling job.

Output: Three CSS files (grid base + recruiting theme + ad portal stub), updated MainLayout with theme wrapper, updated ActivityList with portal-data-grid styling and filter toggle.
</objective>

<execution_context>
@C:/Users/it/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/it/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.2-activity-list-layout-matching/03.2-RESEARCH.md

@src/SignaturPortal.Web/Components/App.razor
@src/SignaturPortal.Web/Components/Layout/MainLayout.razor
@src/SignaturPortal.Web/Components/Layout/MainLayout.razor.css
@src/SignaturPortal.Web/Components/Layout/NavMenuConfig.cs
@src/SignaturPortal.Web/Components/Services/NavigationConfigService.cs
@src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor
@src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor.cs
@src/SignaturPortal.Web/wwwroot/app.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create portal theme CSS infrastructure and wire into layout</name>
  <files>
    src/SignaturPortal.Web/wwwroot/css/portal-themes/_grid-base.css
    src/SignaturPortal.Web/wwwroot/css/portal-themes/theme-recruiting.css
    src/SignaturPortal.Web/wwwroot/css/portal-themes/theme-adportal.css
    src/SignaturPortal.Web/Components/App.razor
    src/SignaturPortal.Web/Components/Layout/NavMenuConfig.cs
    src/SignaturPortal.Web/Components/Services/NavigationConfigService.cs
    src/SignaturPortal.Web/Components/Layout/MainLayout.razor
  </files>
  <action>
    **Create CSS theme files** in `wwwroot/css/portal-themes/`:

    1. **`theme-recruiting.css`** -- Define CSS custom properties on `.theme-recruiting` class. Use EXACT values from research (legacy default.css):
       - `--portal-grid-bg: #e6f6f6`
       - `--portal-grid-header-bg: #e6f6f6`
       - `--portal-grid-cell-bg: #fff`
       - `--portal-grid-cell-border: #e6f6f6`
       - `--portal-grid-hover-bg: #e6f6f6`
       - `--portal-grid-selected-bg: #f6fbfb`
       - `--portal-grid-hover-cursor: pointer`
       - `--portal-grid-header-font-size: 14px`
       - `--portal-grid-cell-font-size: 14px`
       - `--portal-grid-cell-padding: 11px 13px`
       - `--portal-grid-header-padding: 11px 13px`
       - `--portal-grid-font-family: Tahoma, "Times New Roman", Arial, sans-serif`
       - `--portal-grid-text-color: #000`
       - `--portal-grid-headline-bg: #e6f6f6`
       - `--portal-grid-headline-color: #000`
       - `--portal-grid-headline-font-size: 15px`
       - `--portal-grid-headline-padding: 11px 20px`
       - `--portal-grid-headline-border-radius: 4px`
       - `--portal-primary: #1a9b89`
       - `--portal-primary-dark: #178a79`
       - `--portal-primary-darkest: #054541`
       - `--portal-action-hover-bg: #1a9b89`

    2. **`theme-adportal.css`** -- Stub file for ad portal. Define `.theme-adportal` class with the same CSS custom property names but purple palette (#421a56 primary, #f0edf2 background tints, #2c0740 dark). Copy the EXACT variable list from research Example 5. Include a comment: "/* Ad portal theme -- stub for reusability validation. Activate by switching ThemeCssClass. */"

    3. **`_grid-base.css`** -- Shared grid styles referencing `var(--portal-grid-*)` variables. Include rules for:
       - `.portal-data-grid` root (font-family, color, background-color, padding: 0 7px 7px 7px)
       - `.portal-data-grid .mud-table-toolbar` (headline bar: bg, color, font-size, font-weight bold, min-height 44px, padding, border-top-left/right-radius)
       - `.portal-data-grid .mud-table-head .mud-table-cell` (header cells: bg, padding, font-size, white-space nowrap, border, color)
       - `.portal-data-grid .mud-table-body .mud-table-cell` (body cells: bg, padding, font-size, border, vertical-align middle)
       - `.portal-data-grid .mud-table-body .mud-table-row:hover .mud-table-cell` (hover: bg, cursor)
       - `.portal-data-grid .mud-table-body .mud-table-row.selected .mud-table-cell` (selected: bg)
       - `.portal-data-grid .mud-table-pagination` (font-size 14px, font-family)
       - `.portal-data-grid.mud-table` (box-shadow: none -- remove MudBlazor default shadow)
       - All values MUST reference CSS variables (no hardcoded hex colors).

    **Add CSS link references** in `App.razor`:
    - Add three `<link>` elements BEFORE the app.css link (so app.css can override if needed):
      ```
      <link rel="stylesheet" href="css/portal-themes/theme-recruiting.css" />
      <link rel="stylesheet" href="css/portal-themes/theme-adportal.css" />
      <link rel="stylesheet" href="css/portal-themes/_grid-base.css" />
      ```
    - NOTE: Do NOT use `@Assets[]` for these -- they are static CSS files, not fingerprinted assets. Use plain `href` paths.

    **Add ThemeCssClass to NavMenuConfig:**
    - Add property `public string ThemeCssClass { get; set; } = "theme-recruiting";` to `NavMenuConfig`

    **Set ThemeCssClass in NavigationConfigService:**
    - In `GetConfigForRoute`, set `ThemeCssClass = "theme-recruiting"` in the returned config. (Currently all routes use recruiting portal. Future portals will use different theme classes based on route area.)

    **Wrap MainLayout body with theme class:**
    - In `MainLayout.razor`, the current `<div class="page">` should get the theme class from NavMenuConfig. Since MainLayout doesn't currently use NavigationConfigService, use a simpler approach: add `class="theme-recruiting"` directly to the `<div class="page">` wrapper. This is sufficient because the entire app is currently the recruiting portal. When ad portal routes are added in the future, this will be driven by NavigationConfigService.ThemeCssClass.
    - Change: `<div class="page">` to `<div class="page theme-recruiting">`
    - Add a comment: `@* Portal theme class -- will be dynamic when multiple portals are active *@`
  </action>
  <verify>
    - Run `dotnet build` in the solution directory to confirm no compilation errors
    - Verify all 3 CSS files exist under `wwwroot/css/portal-themes/`
    - Verify `App.razor` contains the 3 new CSS link references
    - Verify `MainLayout.razor` has `theme-recruiting` class on the page wrapper
    - Verify `NavMenuConfig.cs` has `ThemeCssClass` property
  </verify>
  <done>
    Three portal theme CSS files exist and are referenced in App.razor. MainLayout wraps content in theme-recruiting class. NavMenuConfig model has ThemeCssClass property for future dynamic theming. No hardcoded hex colors in _grid-base.css -- all values use CSS variables.
  </done>
</task>

<task type="auto">
  <name>Task 2: Apply portal grid styling to ActivityList with filter toggle and column widths</name>
  <files>
    src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor
    src/SignaturPortal.Web/Components/Pages/Activities/ActivityList.razor.cs
    src/SignaturPortal.Web/wwwroot/app.css
  </files>
  <action>
    **Update ActivityList.razor MudDataGrid:**

    1. Add `Class="portal-data-grid"` to MudDataGrid
    2. Remove `Dense="true"` (per research -- use explicit CSS padding instead for exact legacy match)
    3. Change `Filterable="true"` to `Filterable="@_showFilters"` to bind to toggle state
    4. Add `FilterMode="DataGridFilterMode.ColumnFilterRow"` (already present, keep it)
    5. Keep `Hover="true"`, `SortMode="SortMode.Multiple"`, `RowClick`, `RowStyle`
    6. Add `<ColGroup>` section BEFORE `<Columns>` with column width control:
       ```razor
       <ColGroup>
           <col />                         @* Headline - flexible fill *@
           <col style="width: 110px;" />   @* Journal No *@
           <col style="width: 130px;" />   @* Deadline *@
           <col style="width: 110px;" />   @* Status *@
           <col style="width: 100px;" />   @* Candidates *@
           <col style="width: 120px;" />   @* Created *@
           <col style="width: 48px;" />    @* View action *@
       </ColGroup>
       ```
    7. Add filter toggle button to `<ToolBarContent>` after the `<MudSpacer />`:
       ```razor
       <MudTooltip Text="@(_showFilters ? "Skjul filtre" : "Vis filtre")">
           <MudIconButton Icon="@Icons.Material.Filled.FilterList"
                          Color="@(_showFilters ? Color.Primary : Color.Default)"
                          OnClick="ToggleFilters" />
       </MudTooltip>
       ```
    8. Remove the wrapping `<div class="activity-list-container">` -- the portal-data-grid CSS handles layout now. Replace with a simple `<div>` or remove entirely if the MudDataGrid is the only child.

    **Update ActivityList.razor.cs code-behind:**

    1. Add field: `private bool _showFilters = false;`
    2. Add method:
       ```csharp
       private void ToggleFilters()
       {
           _showFilters = !_showFilters;
       }
       ```

    **Update app.css:**

    1. Remove or update the `.activity-list-container` rule. Replace with a simple rule if any outer spacing is still needed:
       ```css
       /* Activity List Page */
       .activity-list-container {
           padding: 1rem;
       }
       ```
       Or remove it entirely if the `<div class="activity-list-container">` wrapper was removed.
  </action>
  <verify>
    - Run `dotnet build` to confirm no compilation errors
    - Run the app (`dotnet run` from Web project) and navigate to `/activities`
    - Verify: Grid has no box shadow, cells have Tahoma font, light teal (#e6f6f6) header background
    - Verify: Cell padding visually matches legacy (11px 13px -- not cramped like Dense mode)
    - Verify: Row hover shows light teal background with pointer cursor
    - Verify: Filter row is NOT visible by default
    - Verify: Clicking the filter icon shows the column filter row
    - Verify: Clicking the filter icon again hides the filter row
    - Verify: Column widths are reasonable (Headline fills remaining space, other columns have fixed widths)
    - Verify: Toolbar headline bar has teal background matching legacy content-headline
  </verify>
  <done>
    ActivityList MudDataGrid uses portal-data-grid CSS class with legacy-matching styling. Dense mode removed in favor of explicit CSS padding. Filters hidden by default with toggle button in toolbar. Column widths controlled via ColGroup. All styling comes from CSS variables -- no inline styles or hardcoded colors in the component.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Visual verification of activity list layout matching legacy</name>
  <action>
    Human verifies the activity list visual appearance matches the legacy WebForms layout.
    This is a visual checkpoint -- Claude cannot verify CSS rendering.
  </action>
  <verify>User confirms visual match or describes issues</verify>
  <done>User approves the visual appearance of the activity list</done>
  <what-built>
    Complete portal-themed activity list layout matching the legacy WebForms visual style:
    - Reusable CSS theme system with CSS custom properties (recruiting teal + ad portal purple stub)
    - Activity list with legacy-matching fonts (Tahoma 14px), padding (11px 13px), colors (#e6f6f6 headers/hover)
    - Hidden filters with toggle button in toolbar
    - ColGroup column width control
    - No box shadow, no dense mode -- matches legacy density
  </what-built>
  <how-to-verify>
    1. Navigate to https://localhost:5219/activities (or the running Blazor app URL)
    2. Visual check -- the grid should look like the legacy activity list:
       - Light teal (#e6f6f6) header background and container background
       - White cell backgrounds with light teal borders
       - Tahoma font, comfortable cell padding (not cramped)
       - Toolbar headline bar with teal background
       - No card-like shadow around the grid
    3. Hover over a row -- background should turn light teal with pointer cursor
    4. Click the filter icon (funnel) in the toolbar -- a filter row should appear below headers
    5. Click the filter icon again -- filter row should disappear
    6. Check column widths -- Headline should be the widest column, others should have reasonable fixed widths
    7. Sorting and pagination should still work correctly
    8. Row click should still navigate to activity detail
  </how-to-verify>
  <resume-signal>Type "approved" or describe any visual issues to fix</resume-signal>
</task>

</tasks>

<verification>
- `dotnet build` passes with zero errors
- Activity list page loads and displays data
- Grid visual style matches legacy (font, padding, colors, no shadow)
- Filter toggle works (show/hide)
- Sorting, pagination, row click all still functional
- CSS files use only CSS variable references (no hardcoded hex in _grid-base.css)
- theme-recruiting.css and theme-adportal.css both define the same variable names with different values
</verification>

<success_criteria>
1. The activity list visually matches the legacy layout: Tahoma font, 14px body / 15px headline, 11px 13px padding, #e6f6f6 teal backgrounds, white cells, no shadow
2. Column filters are hidden by default and toggled via a toolbar button
3. All grid styling flows through CSS custom properties -- zero hardcoded colors in the base grid CSS
4. Two portal theme files exist (recruiting teal, ad portal purple stub) proving the pattern is reusable
5. Existing functionality (sorting, pagination, navigation, error handling) is unaffected
</success_criteria>

<output>
After completion, create `.planning/phases/03.2-activity-list-layout-matching/03.2-01-SUMMARY.md`
</output>

---
phase: 03.5-localization
plan: 05
subsystem: ui
tags: [blazor, localization, navmenu, fallback-logic]

# Dependency graph
requires:
  - phase: 03.5-localization plan 03
    provides: "NavMenu localization with LabelKey/PortalNameKey and ResolveLabel/ResolvePortalName methods"
provides:
  - "Correct bracket-notation display for unresolved localization keys in NavMenu"
affects: [localization, navigation]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Direct GetText return without bracket-check filtering"

key-files:
  created: []
  modified:
    - "src/SignaturPortal.Web/Components/Layout/NavMenu.razor.cs"

key-decisions:
  - "Removed bracket-notation suppression -- GetText return value is always the correct display value when a key is configured"

patterns-established:
  - "Localization fallback: return GetText result directly (translated text or bracket notation); only fall back to hardcoded label when no key is configured"

# Metrics
duration: 1min
completed: 2026-02-17
---

# Phase 3.5 Plan 05: Nav Label Bracket Notation Fix Summary

**Removed inverted fallback logic in NavMenu ResolveLabel/ResolvePortalName that suppressed bracket notation for unresolved localization keys**

## Performance

- **Duration:** 1 min
- **Started:** 2026-02-17T00:25:53Z
- **Completed:** 2026-02-17T00:27:16Z
- **Tasks:** 1
- **Files modified:** 1

## Accomplishments
- Fixed ResolveLabel to return L.GetText(key) directly when LabelKey is set
- Fixed ResolvePortalName to return L.GetText(key) directly when PortalNameKey is set
- Removed StartsWith('[') checks that hid unresolved localization keys behind hardcoded Danish text

## Task Commits

Each task was committed atomically:

1. **Task 1: Fix ResolveLabel and ResolvePortalName fallback logic** - `c989a2d` (fix)

**Plan metadata:** [pending] (docs: complete plan)

## Files Created/Modified
- `src/SignaturPortal.Web/Components/Layout/NavMenu.razor.cs` - Simplified ResolveLabel and ResolvePortalName to return GetText result directly

## Decisions Made
- Removed bracket-notation suppression -- the bracket notation IS the desired fallback showing what key needs translating in the database

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
- Build verification failed due to file locks (SignaturPortal.Web.exe running) -- not compilation errors. The change is a trivial 2-line simplification confirmed correct by grep verification (zero StartsWith('[') matches).

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness
- All UAT test failures from plan 03.5-03 are now addressed
- Navigation labels will display bracket notation keys (e.g., [NavigationActivityList]) when no database translations exist
- Ready for Phase 4 or localization database population

---
*Phase: 03.5-localization*
*Completed: 2026-02-17*

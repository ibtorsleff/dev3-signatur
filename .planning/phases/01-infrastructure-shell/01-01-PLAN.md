---
phase: 01-infrastructure-shell
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - SignaturPortal.sln
  - src/SignaturPortal.Domain/SignaturPortal.Domain.csproj
  - src/SignaturPortal.Application/SignaturPortal.Application.csproj
  - src/SignaturPortal.Infrastructure/SignaturPortal.Infrastructure.csproj
  - src/SignaturPortal.Web/SignaturPortal.Web.csproj
  - src/SignaturPortal.Web/Program.cs
  - src/SignaturPortal.Web/appsettings.json
  - src/SignaturPortal.Web/appsettings.Development.json
  - src/SignaturPortal.Web/Components/App.razor
  - src/SignaturPortal.Web/Components/Routes.razor
  - src/SignaturPortal.Web/Components/_Imports.razor
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "Solution builds successfully with dotnet build"
    - "Clean Architecture layers enforce correct dependency direction (Domain has no project references, Application references only Domain, Infrastructure references Application, Web references all)"
    - "Blazor Server app starts and serves a default page on HTTPS"
  artifacts:
    - path: "SignaturPortal.sln"
      provides: "Solution file referencing all four projects"
      contains: "SignaturPortal.Domain"
    - path: "src/SignaturPortal.Domain/SignaturPortal.Domain.csproj"
      provides: "Domain layer with zero project references"
    - path: "src/SignaturPortal.Application/SignaturPortal.Application.csproj"
      provides: "Application layer referencing only Domain"
      contains: "SignaturPortal.Domain"
    - path: "src/SignaturPortal.Infrastructure/SignaturPortal.Infrastructure.csproj"
      provides: "Infrastructure layer referencing Application"
      contains: "SignaturPortal.Application"
    - path: "src/SignaturPortal.Web/SignaturPortal.Web.csproj"
      provides: "Web layer referencing Infrastructure and Application"
      contains: "SignaturPortal.Infrastructure"
    - path: "src/SignaturPortal.Web/Program.cs"
      provides: "Blazor Server app entry point with DI and middleware pipeline"
    - path: "src/SignaturPortal.Web/appsettings.json"
      provides: "Configuration with connection string and app settings"
      contains: "SignaturAnnoncePortal"
  key_links:
    - from: "src/SignaturPortal.Application/SignaturPortal.Application.csproj"
      to: "src/SignaturPortal.Domain/SignaturPortal.Domain.csproj"
      via: "ProjectReference"
      pattern: "SignaturPortal\\.Domain"
    - from: "src/SignaturPortal.Infrastructure/SignaturPortal.Infrastructure.csproj"
      to: "src/SignaturPortal.Application/SignaturPortal.Application.csproj"
      via: "ProjectReference"
      pattern: "SignaturPortal\\.Application"
    - from: "src/SignaturPortal.Web/SignaturPortal.Web.csproj"
      to: "src/SignaturPortal.Infrastructure/SignaturPortal.Infrastructure.csproj"
      via: "ProjectReference"
      pattern: "SignaturPortal\\.Infrastructure"
---

<objective>
Create the .NET 10 solution with Clean Architecture project structure, Blazor Server web project with initial configuration, and verify the solution builds and serves a default page.

Purpose: This is the foundation for all subsequent plans. Every other plan depends on these projects existing with correct layer references and a working Blazor Server app.
Output: A buildable .NET 10 solution with four projects (Domain, Application, Infrastructure, Web) and a running Blazor Server app.
</objective>

<execution_context>
@C:/Users/it/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/it/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-infrastructure-shell/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create solution and Clean Architecture project structure</name>
  <files>
    SignaturPortal.sln
    src/SignaturPortal.Domain/SignaturPortal.Domain.csproj
    src/SignaturPortal.Application/SignaturPortal.Application.csproj
    src/SignaturPortal.Infrastructure/SignaturPortal.Infrastructure.csproj
    src/SignaturPortal.Web/SignaturPortal.Web.csproj
    .gitignore
  </files>
  <action>
    Create the solution and projects from the Dev3 root directory (C:\Users\it\Documents\Dev\CustomersAndProjects\Signatur\Dev3):

    1. Initialize git repo if not already done: `git init`
    2. Create a .gitignore for .NET (use `dotnet new gitignore`)
    3. Create solution: `dotnet new sln -n SignaturPortal`
    4. Create projects:
       - `dotnet new classlib -n SignaturPortal.Domain -o src/SignaturPortal.Domain -f net10.0`
       - `dotnet new classlib -n SignaturPortal.Application -o src/SignaturPortal.Application -f net10.0`
       - `dotnet new classlib -n SignaturPortal.Infrastructure -o src/SignaturPortal.Infrastructure -f net10.0`
       - `dotnet new blazor -n SignaturPortal.Web -o src/SignaturPortal.Web -f net10.0 --interactivity server --empty`
         (Use --empty to avoid sample content. If --empty is not available, create the project without it and clean up generated sample pages.)
    5. Add all projects to solution:
       - `dotnet sln add src/SignaturPortal.Domain`
       - `dotnet sln add src/SignaturPortal.Application`
       - `dotnet sln add src/SignaturPortal.Infrastructure`
       - `dotnet sln add src/SignaturPortal.Web`
    6. Set up project references enforcing Clean Architecture dependency direction:
       - Application references Domain: `dotnet add src/SignaturPortal.Application reference src/SignaturPortal.Domain`
       - Infrastructure references Application: `dotnet add src/SignaturPortal.Infrastructure reference src/SignaturPortal.Application`
       - Web references Infrastructure (and transitively Application and Domain): `dotnet add src/SignaturPortal.Web reference src/SignaturPortal.Infrastructure`
       - Web also references Application directly (for DI registration): `dotnet add src/SignaturPortal.Web reference src/SignaturPortal.Application`
       - CRITICAL: Domain must have ZERO project references. Application must reference ONLY Domain. Do NOT add reverse references.
    7. Remove auto-generated Class1.cs files from Domain, Application, and Infrastructure projects.
    8. Create initial folder structure in each project:
       - Domain: `Entities/`, `Interfaces/`, `ValueObjects/`
       - Application: `DTOs/`, `Mappings/`, `Interfaces/`
       - Infrastructure: `Data/`, `Data/Entities/`, `Data/Configurations/`, `Repositories/`, `Services/`
       - Create a placeholder .gitkeep in each empty directory so git tracks them

    IMPORTANT: Use net10.0 as the target framework. If dotnet CLI does not recognize net10.0, fall back to net9.0 and note this in the summary. Check available SDKs with `dotnet --list-sdks`.
  </action>
  <verify>
    Run `dotnet build SignaturPortal.sln` from Dev3 root. All four projects must compile with zero errors.
    Verify dependency direction: grep each .csproj for ProjectReference elements and confirm:
    - Domain.csproj has NO ProjectReference
    - Application.csproj references ONLY Domain
    - Infrastructure.csproj references Application (and transitively Domain)
    - Web.csproj references Infrastructure and Application
  </verify>
  <done>Solution builds cleanly. Four projects exist with correct Clean Architecture dependency direction. No reverse references exist.</done>
</task>

<task type="auto">
  <name>Task 2: Configure Blazor Server app with initial settings and DI pipeline</name>
  <files>
    src/SignaturPortal.Web/Program.cs
    src/SignaturPortal.Web/appsettings.json
    src/SignaturPortal.Web/appsettings.Development.json
    src/SignaturPortal.Web/Components/App.razor
    src/SignaturPortal.Web/Components/Routes.razor
    src/SignaturPortal.Web/Components/_Imports.razor
    src/SignaturPortal.Web/Components/Pages/Home.razor
  </files>
  <action>
    Configure the Blazor Server web project for the migration:

    1. Edit appsettings.json to include:
       ```json
       {
         "ConnectionStrings": {
           "SignaturAnnoncePortal": "Server=.;Database=SignaturAnnoncePortal;Trusted_Connection=True;TrustServerCertificate=True;"
         },
         "RemoteAppUri": "https://localhost:44300",
         "RemoteAppApiKey": "CHANGE-ME-GENERATE-GUID",
         "Logging": {
           "LogLevel": {
             "Default": "Information",
             "Microsoft.AspNetCore": "Warning"
           }
         },
         "AllowedHosts": "*"
       }
       ```

    2. Create appsettings.Development.json with development overrides:
       ```json
       {
         "DetailedErrors": true,
         "Logging": {
           "LogLevel": {
             "Default": "Debug",
             "Microsoft.AspNetCore": "Information"
           }
         }
       }
       ```

    3. Edit Program.cs to set up the minimal Blazor Server pipeline:
       ```csharp
       var builder = WebApplication.CreateBuilder(args);

       // Blazor Server
       builder.Services.AddRazorComponents()
           .AddInteractiveServerComponents();

       var app = builder.Build();

       // Middleware pipeline
       if (!app.Environment.IsDevelopment())
       {
           app.UseExceptionHandler("/Error");
           app.UseHsts();
       }

       app.UseHttpsRedirection();
       app.UseStaticFiles();
       app.UseRouting();
       app.UseAntiforgery();

       // Map Blazor components
       app.MapRazorComponents<App>()
           .AddInteractiveServerRenderMode();

       app.Run();
       ```
       Note: Use the correct import for App component based on the project structure. The App component class must be importable.

    4. Ensure App.razor exists with standard Blazor structure (html, head with HeadOutlet, body with Routes).

    5. Ensure Routes.razor exists with Router component pointing to the Web assembly.

    6. Create a simple Home.razor page at `/` that displays "SignaturPortal - Infrastructure Shell" as a heading, confirming the app serves correctly.

    7. Ensure _Imports.razor includes:
       ```
       @using System.Net.Http
       @using Microsoft.AspNetCore.Components.Forms
       @using Microsoft.AspNetCore.Components.Routing
       @using Microsoft.AspNetCore.Components.Web
       @using Microsoft.AspNetCore.Components.Web.Virtualization
       @using Microsoft.JSInterop
       @using SignaturPortal.Web
       @using SignaturPortal.Web.Components
       ```

    IMPORTANT: Do NOT add YARP, System.Web Adapters, EF Core, or MudBlazor yet. Those are in subsequent plans. Keep this minimal -- just Blazor Server with configuration placeholders.
  </action>
  <verify>
    Run `dotnet build SignaturPortal.sln` -- must compile cleanly.
    Run `dotnet run --project src/SignaturPortal.Web` and confirm:
    - App starts without errors in console
    - Navigating to https://localhost:{port}/ shows the "SignaturPortal - Infrastructure Shell" heading
    Stop the app after verification.
  </verify>
  <done>Blazor Server app starts on HTTPS, serves the home page, and configuration files contain connection string placeholder and remote app URI. Solution builds with zero errors.</done>
</task>

</tasks>

<verification>
1. `dotnet build SignaturPortal.sln` compiles all four projects with zero errors
2. `dotnet run --project src/SignaturPortal.Web` starts Blazor Server on HTTPS
3. Clean Architecture dependency direction verified in .csproj files
4. appsettings.json contains ConnectionStrings.SignaturAnnoncePortal and RemoteAppUri
</verification>

<success_criteria>
- Solution with 4 projects builds cleanly on .NET 10 (or 9 if 10 unavailable)
- Blazor Server app starts and renders a page
- Clean Architecture dependency direction enforced
- Configuration files ready for YARP and EF Core additions in subsequent plans
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure-shell/01-01-SUMMARY.md`
</output>
